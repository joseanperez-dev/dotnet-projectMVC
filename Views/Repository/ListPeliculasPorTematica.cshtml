@model projectMVC.Models.PeliculaViewModel
@{
    ViewData["Title"] = "Repository Pattern - Peliculas";
    string FlashClass = (string) TempData["FlashClass"];
    string FlashMessage = (string) TempData["FlashMessage"];
    string url = "/repository/peliculas";
    string urlActual = url + "/tematica";
    int previous = Model.PagingInfo.CurrentPage - 1;
    int next = Model.PagingInfo.CurrentPage + 1;
}
<h1>Repository Pattern - Películas de @ViewBag.TematicaNombre</h1>
@if(FlashClass != null)
{
    <div class="alert alert-@FlashClass alert-dismissible fade show" role="alert">
        @FlashMessage
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="row">
    <div class="col-6">&nbsp;</div>
    <div class="col-6">
        <form name="form_search"  action="@url/search" method="GET">
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Buscar" name="searcher" id="searcher"/>
                <input type="hidden" name="page" value="1"/>
                <span class="input-group-text" id="basic-addon2">
                    <a href="javascript:void(0)" class="btn " onclick="searcher();">
                        <i class="fas fa-search">Buscar</i>
                    </a>
                </span>
            </div>
        </form>
    </div>
</div>
<div class="row">
    <p class="d-flex justify-content-end">
        <a asp-action="AddPelicula" asp-controller="repository" class="btn btn-success">
            <i class="fas fa-plus"></i>Crear
        </a>
    </p>
    <div class="table-responsive">
        @if(Model.PagingInfo.TotalItems > 0)
        {
            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Slug</th>
                        <th>Descripción</th>
                        <th>Foto</th>
                        <th>Fecha</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach(var item in Model.Peliculas) 
                    {
                        <tr>
                            <td>@Html.DisplayFor(m => item.Id)</td>
                            <td>@Html.DisplayFor(m => item.Nombre)</td>
                            <td>@Html.DisplayFor(m => item.Slug)</td>
                            <td>@Html.DisplayFor(m => item.Descripcion)</td>
                            <td><a href="@url/fotos/@item.Id">Imágenes</a></td>
                            <td>@Html.DisplayFor(m => item.Fecha)</td>
                            <td>
                                <a asp-action="EditPelicula" asp-controller="repository" asp-route-id="@item.Id" class="btn btn-primary">
                                    Edit
                                </a>
                                <a href="javascript:void(0);" onclick="confirmSweet('¿Desea eliminar la película?', '/repository/peliculas/delete/@item.Id')" class="btn btn-danger">
                                    Delete
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center">
                    <li class="page-item">
                        <a class="page-link" title="Primera" href="@urlActual/@ViewBag.TematicaId?page=1">First</a>
                    </li>
                    <li class="page-item">
                        <a class="btn btn-default page-link @((int)Model.PagingInfo.CurrentPage > 1 ? "" : "disabled")" titleaction="Previous" href="@urlActual/@ViewBag.TematicaId?page=@previous">Prev</a>
                    </li>
                    @for (var i=1; i < @ViewBag.Pages + 1; i++) 
                    {
                        <li class="page-item @((int)Model.PagingInfo.CurrentPage==i ? "active" : "")" >
                            <a class="btn btn-default page-link" href="@urlActual/@ViewBag.TematicaId?page=@i">@i</a>
                        </li>
                    }
                    <li class="page-item">
                        <a class="btn btn-default page-link @((int)Model.PagingInfo.CurrentPage==@ViewBag.Pages ? "disabled" : "")" title="Next" href="@urlActual/@ViewBag.TematicaId?page=@next">Next</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="@urlActual/@ViewBag.TematicaId?page=@ViewBag.Pages" title="last">Last</a>
                    </li>
                </ul>
            </nav>
        } else 
        {
            <p>No hay registros</p>
        }
    </div>
</div>
    <script>
    function confirmSweet(question, path) {
    Swal.fire({
        title: question,
        icon: 'error',
        showDenyButton: true,
        showCancelButton: false,
        confirmButtonText: "Sí",
        confirmButtonColor: "#3085d6",
        cancelButtonText: "No",
        cancelButtonColor: "#d33"
    }).then((result) => {
        if (result.isConfirmed) {
            window.location=path
        }
    });
}
</script>
