@model projectMVC.Models.PeliculaFotoViewModel
@{
    ViewData["Title"] = "Repository Pattern - Peliculas";
    string FlashClass = (string) TempData["FlashClass"];
    string FlashMessage = (string) TempData["FlashMessage"];
    string url = "/repository/peliculas";
}
<h1>Fotos de @ViewBag.Nombre</h1>
@if(FlashClass != null)
{
    <div class="alert alert-@FlashClass alert-dismissible fade show" role="alert">
        @FlashMessage
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="row">
    <form asp-controller="repository" asp-action="ListPeliculasFotos" method="POST" enctype="multipart/form-data">
        <div class="row">
            <div class="form-group">
                <label for="image">Foto</label>
                <input type="file" name="files" id="fileUpload" multiple class="form-control" />
            </div>
        </div>
        <input type="hidden" asp-for="@Model.PeliculaFoto.PeliculaId" value="@ViewBag.Id"/>
        <input type="submit" value="Subir" class="btn btn-primary"/>
    </form>
</div>
<hr/>
<div class="row">
    <div class="table-responsive">
        @if(Model.PeliculasFotos.Count() > 0)
        {
            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach(var item in Model.PeliculasFotos) 
                    {
                        <tr>
                            <td><img src="/uploads/peliculas/@item.Nombre" width="200"/></td>
                            <td>
                                <a href="javascript:void(0);" onclick="confirmSweet('¿Desea eliminar la foto?', '/repository/peliculas/fotos/delete/@item.Id')" class="btn btn-danger">
                                    Delete
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        } else 
        {
            <p>No hay registros</p>
        }
    </div>
</div>
    <script>
    function confirmSweet(question, path) {
        Swal.fire({
            title: question,
            icon: 'error',
            showDenyButton: true,
            showCancelButton: false,
            confirmButtonText: "Sí",
            confirmButtonColor: "#3085d6",
            cancelButtonText: "No",
            cancelButtonColor: "#d33"
        }).then((result) => {
            if (result.isConfirmed) {
                window.location=path
            }
        });
    }

    function searcher() {
        if (document.getElementById('searcher').value==0) {
            document.getElementById('searcher').value = "";
        }
        alert(document.getElementById('searcher').value);
        document.form_search.submit();
    }
</script>
